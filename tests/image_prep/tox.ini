[tox]
envlist =
    ansible2.3,
    ansible5
    ansible9
    ansible11
skipsdist = true

[testenv]
setenv =
    ANSIBLE_STRATEGY_PLUGINS={envsitepackagesdir}/ansible_mitogen/plugins/strategy

[testenv:ansible2.3]
basepython = python2
deps =
    ansible>=2.3,<2.4
    docker-py>=1.7.0
    mitogen~=0.2.0
install_command =
    python -m pip --no-python-version-warning install {opts} {packages}
commands =
    ansible-playbook -l 'localhost,ansible_2_3' setup_ansible2.3.yml

[testenv:ansible5]
basepython = python3
deps =
    ansible~=5.0
    docker>=1.8.0
    mitogen~=0.3.0
    passlib
setenv =
    ANSIBLE_PYTHON_INTERPRETER=auto_silent
    ANSIBLE_STDOUT_CALLBACK=yaml
commands =
    ansible-playbook -l 'localhost,ansible_5' setup.yml

[testenv:ansible9]
basepython = python3
deps =
    ansible~=9.0
    docker>=1.8.0
    mitogen~=0.3.0
    passlib
setenv =
    ANSIBLE_PYTHON_INTERPRETER=auto_silent
    ANSIBLE_STDOUT_CALLBACK=yaml
commands =
    ansible-playbook -l 'localhost,ansible_9' setup.yml

[testenv:ansible11]
basepython = python3
deps =
    ansible~=11.0
    docker>=1.8.0
    mitogen~=0.3.0
    passlib
setenv =
    ANSIBLE_PYTHON_INTERPRETER=auto_silent
    ANSIBLE_STDOUT_CALLBACK=yaml
commands =
    ansible-playbook -l 'localhost,ansible_11' setup.yml
